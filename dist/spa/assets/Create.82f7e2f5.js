import{c as y,Q as D}from"./uid.64ab0e0b.js";import{Q as h}from"./QSelect.71bf0f2d.js";import{Q as _,h as b,g as f}from"./QDialog.9d2c60d3.js";import{Q as P}from"./QSeparator.516e9541.js";import{Q as V}from"./QInput.e7ac3a60.js";import{Q as k}from"./QMarkupTable.94f5bfb2.js";import{_ as U,p as K,r as u,t as p,x as g,y as o,z as s,B as c,ct as N,K as l,b5 as w,bx as v,C as m,E as Q,F as $,G as C,J as F,b4 as R,A as I}from"./index.74a171dd.js";import{Q as q}from"./QForm.d097a1fb.js";import{Q as B}from"./QPage.4ed51d90.js";const L=K({props:["user"],setup(){return{list_year:u([]),year:u(null),list_regency:u([]),regency:u(null),fields:u([]),loading:u(!1)}},mounted(){this.getYear()},methods:{getYear(){this.loading=!0,this.$api.get("/forms?Limit=-").then(t=>{this.list_year=t.data.data.Rows.map(a=>({label:a.Year,value:a.ID})),this.loading=!1}).catch(t=>{console.log(t)})},filterRegency(t,a){if(t===""){a(()=>{var n;this.list_regency=(n=this.user)==null?void 0:n.Group.Details.map(i=>({label:i.RegencyCity.Name,value:i.RegencyCityID,province:i.RegencyCity.Province.LongName}))});return}a(()=>{var i;const n=t.toLowerCase();this.list_regency=(i=this.user)==null?void 0:i.Group.Details.map(d=>({label:d.RegencyCity.Name,value:d.RegencyCityID,province:d.RegencyCity.Province.LongName})).filter(d=>d.label.toLowerCase().indexOf(n)>-1)})},getForm(t){this.loading=!0;const a=this.list_year.find(n=>n.value==t).label;this.$api.get("/forms/"+a+'?Relation={"Name": "Fields"}').then(n=>(this.fields=n.data.data.Fields,this.loading=!1,n)).then(n=>{this.$refs.myForm.resetValidation()}).catch(n=>{console.log(n)})},submit(){this.loading=!0;const t={FormID:this.year,UserID:this.user.ID,RegencyCityID:this.regency,FieldResponse:this.fields.map(a=>({FieldID:a.ID,Value:a.Value}))};this.$api.post("form-responses",t).then(a=>{this.$q.notify({message:"Data berhasil tersimpan",color:"positive"}),this.getForm(this.year)}).catch(a=>{console.log(a)})}}}),S=l("div",{class:"tw-text-3xl tw-mb-4"},"Buat Penginputan",-1),T={class:"q-tr--no-hover"},A=l("td",null,[l("div",{class:""},"-")],-1),z=l("td",null,[l("div",{class:""},"Pilih Tahun Anggaran")],-1),G={class:"md:tw-block tw-hidden"},Y={class:"tw-table-row md:tw-hidden"},E={colspan:"100%"},M={class:"q-tr--no-hover"},j=l("td",null,"-",-1),J=l("td",null,"Pilih Kabupaten Kota",-1),O={class:"md:tw-block tw-hidden"},H={class:"tw-table-row md:tw-hidden"},W={colspan:"100%"},X={class:"q-tr--no-hover"},Z={colspan:"100%"},x={class:"q-tr--no-hover"},ee={class:"md:tw-block tw-hidden"},te={class:"tw-table-row md:tw-hidden"},le={colspan:"100%"},ae={class:"tw-flex tw-justify-center tw-mt-4 tw-gap-4"};function se(t,a,n,i,d,oe){return p(),g(B,{class:"tw-p-6"},{default:o(()=>[S,s(D,{flat:""},{default:o(()=>[s(y,{class:"text-primary tw-font-bold"},{default:o(()=>[c(" Anggaran APBD Kab/Kota ")]),_:1}),s(y,{class:"q-pt-none"},{default:o(()=>[s(q,{onSubmit:N(t.submit,["prevent"]),ref:"myForm"},{default:o(()=>[s(k,{flat:"",separator:"none",class:"tw-h-auto"},{default:o(()=>[l("tbody",null,[l("tr",T,[A,z,l("td",G,[s(h,{dense:"",filled:"",modelValue:t.year,"onUpdate:modelValue":[a[0]||(a[0]=e=>t.year=e),t.getForm],label:"Pilih Tahun",options:t.list_year,"map-options":"","emit-value":"",rules:[e=>!!e]},null,8,["modelValue","options","onUpdate:modelValue","rules"])])]),l("tr",Y,[l("td",E,[s(h,{dense:"",filled:"",modelValue:t.year,"onUpdate:modelValue":[a[1]||(a[1]=e=>t.year=e),t.getForm],label:"Pilih Tahun",options:t.list_year,"map-options":"","emit-value":"",rules:[e=>!!e]},null,8,["modelValue","options","onUpdate:modelValue","rules"])])]),l("tr",M,[j,J,l("td",O,[s(h,{dense:"",filled:"",modelValue:t.regency,"onUpdate:modelValue":a[2]||(a[2]=e=>t.regency=e),label:"Pilih Kabupaten Kota",options:t.list_regency,onFilter:t.filterRegency,"use-input":"","map-options":"","emit-value":"",rules:[e=>!!e]},{option:o(e=>[s(_,w(v(e.itemProps)),{default:o(()=>[s(b,null,{default:o(()=>[s(f,null,{default:o(()=>[c(m(e.opt.label),1)]),_:2},1024),s(f,{caption:""},{default:o(()=>[c(m(e.opt.province),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","onFilter","rules"])])]),l("tr",H,[l("td",W,[s(h,{dense:"",filled:"",modelValue:t.regency,"onUpdate:modelValue":a[3]||(a[3]=e=>t.regency=e),label:"Pilih Kabupaten Kota",options:t.list_regency,onFilter:t.filterRegency,"use-input":"","map-options":"","emit-value":"",rules:[e=>!!e]},{option:o(e=>[s(_,w(v(e.itemProps)),{default:o(()=>[s(b,null,{default:o(()=>[s(f,null,{default:o(()=>[c(m(e.opt.label),1)]),_:2},1024),s(f,{caption:""},{default:o(()=>[c(m(e.opt.province),1)]),_:2},1024)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","options","onFilter","rules"])])]),l("tr",X,[l("td",Z,[s(P,{class:"tw-w-full"})])]),(p(!0),Q(C,null,$(t.fields,e=>(p(),Q(C,{key:e.ID},[l("tr",x,[l("td",{class:R(e.class)},m(e.Code),3),l("td",{class:R(e.class)},m(e.Label),3),l("td",ee,[e.Type=="currency"?(p(),g(V,{key:0,dense:"",filled:"",mask:"###,###,###,###,###,###,###,###,###,###","reverse-fill-mask":"",prefix:"Rp",modelValue:e.Value,"onUpdate:modelValue":r=>e.Value=r,rules:[r=>!!r&&e.IsRequired]},null,8,["modelValue","onUpdate:modelValue","rules"])):I("",!0)])]),l("tr",te,[l("td",le,[e.Type=="currency"?(p(),g(V,{key:0,dense:"",filled:"",mask:"###,###,###,###,###,###,###,###,###,###","reverse-fill-mask":"",prefix:"Rp",modelValue:e.Value,"onUpdate:modelValue":r=>e.Value=r,rules:[r=>!!r&&e.IsRequired]},null,8,["modelValue","onUpdate:modelValue","rules"])):I("",!0)])])],64))),128))])]),_:1}),l("div",ae,[s(F,{outline:"",color:"primary",unelevated:"",label:"Kembali",to:{name:"penginputan-index"},"no-caps":"",loading:t.loading},null,8,["loading"]),s(F,{type:"submit",color:"primary",unelevated:"",label:"Simpan","no-caps":"",loading:t.loading},null,8,["loading"])])]),_:1},8,["onSubmit"])]),_:1})]),_:1})]),_:1})}var fe=U(L,[["render",se]]);export{fe as default};
